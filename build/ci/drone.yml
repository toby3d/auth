---
kind: pipeline
type: docker
name: default

environment:
  CGO_ENABLED: 0

steps:
  - name: test
    image: golang:1.18
    volumes:
      - name: modules
        path: /go/pkg/mod
    commands:
      - make check

  - name: build
    image: golang:1.18
    volumes:
      - name: modules
        path: /go/pkg/mod
    commands:
      - make
    depends_on:
      - test

  - name: finish
    image: alpine
    depends_on:
      - build

volumes:
  - name: modules
    temp: {}
